
var fonts={};

fonts["large"]={
    metrics:{
        width:13,
        height:12,
        spacing:2
    },
    order:[],
    glyphs:{
        "A":[
            "     ###     ",
            "     ###     ",
            "    #####    ",
            "    #####    ",
            "   ### ###   ",
            "   ### ###   ",
            "  ###   ###  ",
            "  ###   ###  ",
            " ########### ",
            " ########### ",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
        ],
        "B":[
            "###########  ",
            "############ ",
            "#############",
            "###       ###",
            "#############",
            "############ ",
            "#############",
            "###       ###",
            "###       ###",
            "#############",
            "############ ",
            "###########  ",
        ],
        "C":[
            "  ###########",
            " ############",
            "#############",
            "###          ",
            "###          ",
            "###          ",
            "###          ",
            "###          ",
            "###          ",
            "#############",
            " ############",
            "  ###########",
        ],
        "D":[
            "###########  ",
            "############ ",
            "#############",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "#############",
            "############ ",
            "###########  ",
        ],
        "E":[
            "############ ",
            "############ ",
            "############ ",
            "###          ",
            "##########   ",
            "##########   ",
            "##########   ",
            "###          ",
            "###          ",
            "#############",
            "#############",
            "#############",
        ],
        "F":[
            "############ ",
            "############ ",
            "############ ",
            "###          ",
            "###          ",
            "##########   ",
            "##########   ",
            "##########   ",
            "###          ",
            "###          ",
            "###          ",
            "###          ",
        ],
        "G":[
            "  ###########",
            " ############",
            "#############",
            "###          ",
            "###          ",
            "###    ######",
            "###    ######",
            "###    ######",
            "###       ###",
            "#############",
            " ########### ",
            "  #########  ",
        ],
        "H":[
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "#############",
            "#############",
            "#############",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
        ],
        "I":[
            "#############",
            "#############",
            "#############",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "#############",
            "#############",
            "#############",
        ],
        "J":[
            "          ###",
            "          ###",
            "          ###",
            "          ###",
            "          ###",
            "          ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "#############",
            " ########### ",
            "  #########  ",
        ],
        "K":[
            "###       ###",
            "###      ### ",
            "###     ###  ",
            "###    ###   ",
            "#########    ",
            "########     ",
            "#########    ",
            "###   ####   ",
            "###    ####  ",
            "###     #### ",
            "###      ####",
            "###       ###",
        ],
        "L":[
            "###          ",
            "###          ",
            "###          ",
            "###          ",
            "###          ",
            "###          ",
            "###          ",
            "###          ",
            "###          ",
            "#############",
            "#############",
            "#############",
        ],
        "M":[
            "###       ###",
            "####     ####",
            "#####   #####",
            "###### ######",
            "#############",
            "### ##### ###",
            "###  ###  ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
        ],
        "N":[
            "###       ###",
            "####      ###",
            "#####     ###",
            "######    ###",
            "#######   ###",
            "### ####  ###",
            "###  #### ###",
            "###   #######",
            "###    ######",
            "###     #####",
            "###      ####",
            "###       ###",
            "###       ###",
            "###       ###",
        ],
        "O":[
            "  #########  ",
            " ########### ",
            "#############",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "#############",
            " ########### ",
            "  #########  ",
        ],
        "P":[
            "###########  ",
            "############ ",
            "#############",
            "###       ###",
            "###       ###",
            "#############",
            "############ ",
            "###########  ",
            "###          ",
            "###          ",
            "###          ",
            "###          ",
        ],
        "Q":[
            "  #########  ",
            " ########### ",
            "#############",
            "###       ###",
            "###       ###",
            "###     # ###",
            "###    ######",
            "###   #######",
            "###    ######",
            "#############",
            " ############",
            "  ########## ",
        ],
        "R":[
            "###########  ",
            "############ ",
            "#############",
            "###       ###",
            "###       ###",
            "#############",
            "############ ",
            "###########  ",
            "###    ####  ",
            "###     #### ",
            "###      ####",
            "###       ###",
        ],
        "S":[
            "  ########## ",
            " ########### ",
            "############ ",
            "###          ",
            "###########  ",
            " ########### ",
            "  ###########",
            "          ###",
            "          ###",
            "#############",
            "############ ",
            "###########  ",
        ],
        "T":[
            "#############",
            "#############",
            "#############",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
        ],
        "U":[
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "#############",
            " ########### ",
            "  #########  ",
        ],
        "V":[
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "####     ####",
            " ####   #### ",
            "  #########  ",
            "   #######   ",
            "    #####    ",
        ],
        "W":[
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###       ###",
            "###  ###  ###",
            "###  ###  ###",
            "###  ###  ###",
            "#############",
            " ########### ",
            "  #### ####  ",
        ],
        "X":[
            "###       ###",
            "####     ####",
            " ####   #### ",
            "  #### ####  ",
            "   #######   ",
            "    #####    ",
            "    #####    ",
            "   #######   ",
            "  #### ####  ",
            " ####   #### ",
            "####     ####",
            "###       ###",
        ],
        "Y":[
            "###       ###",
            "####     ####",
            " ####   #### ",
            "  #### ####  ",
            "   #######   ",
            "    #####    ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
            "     ###     ",
        ],
        "Z":[
            "#############",
            "#############",
            "############ ",
            "       ####  ",
            "      ####   ",
            "     ####    ",
            "    ####     ",
            "   ####      ",
            "  ####       ",
            " ############",
            "#############",
            "#############",
        ],
        " ":[
            "             ",
            "             ",
            "             ",
            "             ",
            "             ",
            "             ",
            "             ",
            "             ",
            "             ",
            "             ",
            "             ",
            "             ",
            "             ",
            "             ",
        ]
    }
};

fonts["small"]={
    metrics:{
        width:7,
        height:8,
        spacing:2
    },
    order:[],
    glyphs:{
        "A":[
            "   #   ",
            "  # #  ",
            " #   # ",
            "#     #",
            "#######",
            "#     #",
            "#     #",
            "#     #",
        ],
        "B":[
            "###### ",
            "#     #",
            "#     #",
            "###### ",
            "#     #",
            "#     #",
            "#     #",
            "###### ",
        ],
        "C":[
            " ######",
            "#      ",
            "#      ",
            "#      ",
            "#      ",
            "#      ",
            "#      ",
            " ######",
        ],
        "D":[
            "###### ",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "###### ",
        ],
        "E":[
            "###### ",
            "#      ",
            "#      ",
            "#####  ",
            "#      ",
            "#      ",
            "#      ",
            "#######",
        ],
        "F":[
            "###### ",
            "#      ",
            "#      ",
            "#####  ",
            "#      ",
            "#      ",
            "#      ",
            "#      ",
        ],
        "G":[
            " ######",
            "#      ",
            "#      ",
            "#      ",
            "#    ##",
            "#     #",
            "#     #",
            " ##### ",
        ],
        "H":[
            "#     #",
            "#     #",
            "#     #",
            "#######",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
        ],
        "I":[
            "#######",
            "   #   ",
            "   #   ",
            "   #   ",
            "   #   ",
            "   #   ",
            "   #   ",
            "#######",
        ],
        "J":[
            "      #",
            "      #",
            "      #",
            "      #",
            "      #",
            "#     #",
            "#     #",
            " ##### ",
        ],
        "K":[
            "#    # ",
            "#   #  ",
            "#  #   ",
            "###    ",
            "#  #   ",
            "#   #  ",
            "#    # ",
            "#     #",
        ],
        "L":[
            "#      ",
            "#      ",
            "#      ",
            "#      ",
            "#      ",
            "#      ",
            "#      ",
            "#######",
        ],
        "M":[
            "#     #",
            "##   ##",
            "# # # #",
            "#  #  #",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
        ],
        "N":[
            "#     #",
            "##    #",
            "# #   #",
            "#  #  #",
            "#   # #",
            "#    ##",
            "#     #",
            "#     #",
        ],
        "O":[
            " ##### ",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            " ##### ",
        ],
        "P":[
            "###### ",
            "#     #",
            "#     #",
            "###### ",
            "#      ",
            "#      ",
            "#      ",
            "#      ",
        ],
        "Q":[
            " ##### ",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#   # #",
            "#    ##",
            " ######",
        ],
        "R":[
            "###### ",
            "#     #",
            "#     #",
            "###### ",
            "#  #   ",
            "#   #  ",
            "#    # ",
            "#     #",
        ],
        "S":[
            " ##### ",
            "#      ",
            "#      ",
            " ##### ",
            "      #",
            "      #",
            "      #",
            "###### ",
        ],
        "T":[
            "#######",
            "   #   ",
            "   #   ",
            "   #   ",
            "   #   ",
            "   #   ",
            "   #   ",
            "   #   ",
        ],
        "U":[
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            " ##### ",
        ],
        "V":[
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            " #   # ",
            "  # #  ",
            "   #   ",
        ],
        "W":[
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#     #",
            "#  #  #",
            "#  #  #",
            " ## ## ",
        ],
        "X":[
            "#     #",
            " #   # ",
            "  # #  ",
            "   #   ",
            "  # #  ",
            " #   # ",
            "#     #",
            "#     #",
        ],
        "Y":[
            "#     #",
            " #   # ",
            "  # #  ",
            "   #   ",
            "   #   ",
            "   #   ",
            "   #   ",
            "   #   ",
        ],
        "Z":[
            "#######",
            "     # ",
            "    #  ",
            "   #   ",
            "  #    ",
            " #     ",
            "#      ",
            "#######",
        ],
        ".":[
            "       ",
            "       ",
            "       ",
            "       ",
            "       ",
            "       ",
            " ##    ",
            " ##    ",
        ],
        ",":[
            "       ",
            "       ",
            "       ",
            "       ",
            "       ",
            " ##    ",
            "  #    ",
            "  #    ",
        ],
        "'":[
            "  ##   ",
            "   #   ",
            "   #   ",
            "       ",
            "       ",
            "       ",
            "       ",
            "       ",
        ],
        "!":[
            " ##    ",
            " ##    ",
            " ##    ",
            " ##    ",
            " ##    ",
            "       ",
            " ##    ",
            " ##    ",
        ],
        " ":[
            "       ",
            "       ",
            "       ",
            "       ",
            "       ",
            "       ",
            "       ",
            "       ",
        ],
    }
};

function canvas_text_init() {
    prop.canvas.text={};
    prop.canvas.text.canvases={}; // one for each font size

    canvas_text_generate();
}

function canvas_text_generate(font) {
    if(font == undefined) {
        for(var i in fonts) {
            canvas_text_generate(i);
        }
    } else {
        var c=document.createElement("canvas");
        f=fonts[font];
        var glyphs=[];
        for(var i in f.glyphs) {
            glyphs.push([i,f.glyphs[i]]);
        }
        c.width=f.metrics.width*glyphs.length*prop.canvas.scale;
        c.height=f.metrics.height*prop.canvas.scale;
        var cc=c.getContext("2d");
        cc.fillStyle="#fff";
        for(var i=0;i<glyphs.length;i++) {
            var xoffs=i*f.metrics.width;
            fonts[font].order.push(glyphs[i][0]);
            for(var row=0;row<f.metrics.height;row++) {
                for(var item=0;item<f.metrics.width;item++) {
                    if(glyphs[i][1][row][item] == "#")
                        cc.fillRect((xoffs+item)*prop.canvas.scale,row*prop.canvas.scale,
                                    prop.canvas.scale,prop.canvas.scale);
                }
            }
        }
        prop.canvas.text.canvases[font]=c;
    }
}

function canvas_text_char(cc,x,y,c,font) {
    var f=fonts[font];
    var ci=f.order.indexOf(c);
    var s=prop.canvas.scale;
    cc.drawImage(prop.canvas.text.canvases[font],
                 ci*f.metrics.width*s,0,f.metrics.width*s,f.metrics.height*s,
                 x*s,y*s,f.metrics.width*s,f.metrics.height*s);
}

function canvas_text_print(cc,x,y,text,font) {
    var f=fonts[font];
    for(var i=0;i<text.length;i++) {
        var xoffs=i*(f.metrics.width+f.metrics.spacing)+x;
        canvas_text_char(cc,xoffs,y,text[i],font);
    }
}